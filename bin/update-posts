#!/usr/bin/env node
const axios = require('axios')
const fs = require('fs')
const _ = require('lodash')

async function main() {
  const { data: posts } = await axios.get('https://dev.to/api/articles', { params: { username: 'goamaral' } })

  for (let post of posts) {
    const postFilePath = getPostFilePath(post)
    const { data: postContent } = await axios.get(`https://dev.to/api/articles/${post.id}`)
    fs.writeFileSync(postFilePath, `---\nlayout: post\ntitle: ${post.title}\n---\n${postContent.body_markdown}`)
  }
}

function getPostFilePath(article) {
  return `_posts/${article.created_at.substring(0, 10)}-${_.kebabCase(article.title)}.md`
}

main()